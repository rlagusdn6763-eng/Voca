<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>오늘의 회화 영단어</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; }
    header { background: #1565c0; color: #fff; padding: 15px; font-size: 20px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
    header .menu-btn { font-size: 22px; background: none; border: none; color: white; cursor: pointer; }
    .container { padding: 15px; }
    .date-area { display: flex; align-items: center; justify-content: center; margin: 15px 0; gap: 10px; }
    .date-view { font-weight: bold; font-size: 18px; }
    button { border: none; border-radius: 6px; padding: 8px 14px; cursor: pointer; font-size: 14px; }
    .btn { background: #e0e0e0; }
    .btn-green { background: #4caf50; color: white; }
    .btn-red { background: #e53935; color: white; }
    .btn-blue { background: #1e88e5; color: white; }
    .btn-outline { background: none; border: 1px solid #ccc; }
    .iconbtn { background: #eee; font-size: 14px; }
    .words { margin-top: 10px; }
    .word { background: white; border-radius: 8px; padding: 12px; margin-bottom: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .word h3 { margin: 0; font-size: 16px; display: flex; justify-content: space-between; align-items: center; }
    .example { font-size: 13px; color: #555; margin-top: 5px; }
    .controls { display: flex; gap: 8px; margin: 10px 0; flex-wrap: wrap; }
    .record-list { margin-top: 10px; }
    .record-item { background: white; border: 1px solid #ddd; padding: 10px; border-radius: 6px; margin-bottom: 6px; display: flex; justify-content: space-between; align-items: center; }
    .record-item input[type=checkbox] { margin-right: 10px; }
    /* 슬라이드 패널 */
    .sidepanel { height: 100%; width: 0; position: fixed; top: 0; right: 0; background: #fff; overflow-x: hidden; transition: 0.3s; padding: 20px; box-shadow: -2px 0 6px rgba(0,0,0,0.2); }
    .sidepanel.open { width: 250px; }
    .logout-btn { background: #e53935; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; margin-top: 10px; }
  </style>
</head>
<body>
  <header>
    <span>오늘의 회화 영단어</span>
    <button class="menu-btn" onclick="togglePanel()">●</button>
  </header>

  <div id="sidePanel" class="sidepanel">
    <h3>계정</h3>
    <div id="authArea">
      <input type="email" id="email" placeholder="이메일"><br><br>
      <input type="password" id="password" placeholder="비밀번호 (8자 이상)"><br><br>
      <button onclick="login()">로그인</button>
      <button onclick="signup()">회원가입</button>
    </div>
    <div id="userArea" style="display:none;">
      <p id="userInfo"></p>
      <button class="logout-btn" onclick="logout()">로그아웃</button>
    </div>
  </div>

  <div class="container">
    <div class="date-area">
      <button id="prevDate" class="iconbtn">◀</button>
      <div id="dateView" class="date-view">YYYY-MM-DD</div>
      <button id="nextDate" class="iconbtn">▶</button>
      <button id="btnToday" class="btn">오늘의 단어</button>
    </div>

    <div class="controls">
      <button id="btnAll" class="btn-blue">전체 재생</button>
      <button id="btnStop" class="btn">정지</button>
      <button id="btnDone" class="btn-green">오늘분 완료</button>
      <button id="btnHard" class="btn-outline">★ 어려운 단어</button>
      <button id="btnRecord" class="btn-outline">기록</button>
      <button id="btnDelete" class="btn-red">기록 삭제</button>
    </div>

    <div class="controls">
      <label>속도 <input type="range" id="speed" min="0.5" max="1.5" step="0.1" value="1"></label>
      <select id="voiceSelect"></select>
    </div>

    <div class="words" id="words"></div>
    <div class="record-list" id="recordList"></div>
  </div>

  <script>
    const $ = id => document.getElementById(id);

    // 사이드 패널 열고 닫기
    function togglePanel() {
      $('sidePanel').classList.toggle('open');
    }

    // 더미 로그인/회원가입/로그아웃
    function login() {
      const email = $('email').value;
      $('authArea').style.display = 'none';
      $('userArea').style.display = 'block';
      $('userInfo').innerText = email + ' 로그인됨';
    }
    function signup() { alert("회원가입은 실제 인증 연동 후 사용하세요."); }
    function logout() {
      $('authArea').style.display = 'block';
      $('userArea').style.display = 'none';
    }

    // 단어 데이터
    let pool = [
      { phrase:"deal with", meaning:"다루다, 처리하다", example:"She had to deal with many problems." },
      { phrase:"depend on", meaning:"의지하다", example:"You can depend on me." },
      { phrase:"along with", meaning:"잘 지내다", example:"Do you get along with your neighbors?" }
    ];

    let currentDate = new Date().toISOString().split('T')[0];
    let records = JSON.parse(localStorage.getItem('records') || '{}');
    let isDeleteMode = false;

    function renderDate() { $('dateView').innerText = currentDate; }

    function renderWords() {
      const words = $('words');
      words.innerHTML = '';
      (records[currentDate] || pool).forEach((w,i)=>{
        let div = document.createElement('div');
        div.className = 'word';
        div.innerHTML = `<h3>${i+1}. ${w.phrase}</h3>
          <p>${w.meaning}</p>
          <p class="example">예문: ${w.example}</p>`;
        words.appendChild(div);
      });
    }

    function renderRecords() {
      const list = $('recordList');
      list.innerHTML = '';
      Object.keys(records).forEach(date=>{
        let div = document.createElement('div');
        div.className = 'record-item';
        if(isDeleteMode){
          div.innerHTML = `<label><input type="checkbox" value="${date}"> ${date}</label>`;
        } else {
          div.innerHTML = `<span>${date}</span>`;
        }
        list.appendChild(div);
      });
    }

    // 전체 재생
    let synth = window.speechSynthesis;
    let voices = [];
    function loadVoices(){
      voices = synth.getVoices();
      const sel = $('voiceSelect');
      sel.innerHTML = '';
      voices.forEach((v,i)=>{
        let opt = document.createElement('option');
        opt.value = i;
        opt.textContent = v.name + ' (' + v.lang + ')';
        sel.appendChild(opt);
      });
    }
    loadVoices();
    window.speechSynthesis.onvoiceschanged = loadVoices;

    function playAll(){
      synth.cancel();
      let selected = voices[$('voiceSelect').value] || voices[0];
      let speed = parseFloat($('speed').value);
      (records[currentDate] || pool).forEach(w=>{
        let u1 = new SpeechSynthesisUtterance(w.phrase);
        u1.voice = selected; u1.rate = speed;
        let u2 = new SpeechSynthesisUtterance(w.meaning);
        u2.voice = selected; u2.rate = speed;
        synth.speak(u1); synth.speak(u2);
      });
    }
    function stopAll(){ synth.cancel(); }

    // 이벤트 바인딩
    $('btnAll').onclick = playAll;
    $('btnStop').onclick = stopAll;
    $('btnDone').onclick = ()=>{
      records[currentDate] = pool;
      localStorage.setItem('records', JSON.stringify(records));
      renderRecords();
      alert("오늘 단어 완료 기록됨");
    };
    $('btnRecord').onclick = ()=>{
      isDeleteMode=false; renderRecords();
    };
    $('btnDelete').onclick = ()=>{
      if(!isDeleteMode){
        isDeleteMode=true; renderRecords();
        let controls = document.createElement('div');
        controls.id='deleteControls';
        controls.innerHTML = `<button onclick="cancelDelete()">취소</button>
          <button onclick="confirmDelete()" class="btn-red">삭제하기</button>`;
        $('recordList').prepend(controls);
      }
    };
    function cancelDelete(){ isDeleteMode=false; renderRecords(); $('deleteControls')?.remove(); }
    function confirmDelete(){
      let checked=[...document.querySelectorAll('#recordList input[type=checkbox]:checked')].map(c=>c.value);
      if(checked.length===0){alert("삭제할 날짜를 선택하세요.");return;}
      checked.forEach(d=>delete records[d]);
      localStorage.setItem('records', JSON.stringify(records));
      cancelDelete();
    }

    $('prevDate').onclick = ()=>{ currentDate = new Date(new Date(currentDate).getTime()-86400000).toISOString().split('T')[0]; renderDate(); renderWords(); };
    $('nextDate').onclick = ()=>{ currentDate = new Date(new Date(currentDate).getTime()+86400000).toISOString().split('T')[0]; renderDate(); renderWords(); };
    $('btnToday').onclick = ()=>{ currentDate = new Date().toISOString().split('T')[0]; renderDate(); renderWords(); };

    renderDate(); renderWords(); renderRecords();
  </script>
</body>
</html>
