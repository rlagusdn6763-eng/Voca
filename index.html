<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>오늘의 회화 영단어</title>
  <style>
    :root{
      --blue:#1f6ff0;
      --blue2:#0e5de5;
      --green:#15a36e;
      --red:#e64545;
      --card:#ffffff;
      --bg:#f6f7fb;
      --text:#0b1220;
      --muted:#7b8194;
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Apple SD Gothic Neo,Malgun Gothic,Segoe UI Emoji,Arial,sans-serif;
    }

    /* 헤더 */
    .appbar{
      position:sticky;top:0;z-index:10;
      padding:14px 16px 18px;
      background:linear-gradient(90deg,var(--blue),var(--blue2));
      color:#fff; box-shadow:0 1px 0 rgba(0,0,0,.04);
    }
    .appbar .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{font-weight:800;letter-spacing:-.2px}
    .brand .sub{opacity:.85;font-weight:700}
    .icon-btn{
      display:inline-flex;align-items:center;justify-content:center;
      width:44px;height:44px;border-radius:14px;border:0;background:rgba(255,255,255,.16);
      color:#fff;cursor:pointer;backdrop-filter:blur(6px)
    }

    /* 상단 카드(날짜/컨트롤) */
    .container{padding:14px 16px 28px;max-width:860px;margin:0 auto}
    .panel{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 6px 24px rgba(20,32,80,.08)}
    .datebar{display:grid;grid-template-columns:56px 1fr 56px;gap:10px;align-items:center;margin-bottom:12px}
    .date-chip{
      width:100%;text-align:center;padding:10px 12px;border-radius:24px;background:#fff;border:1px solid #e9ecf2;
      font-weight:800;letter-spacing:.5px;
      font-size:clamp(18px, 3.5vw, 22px); /* << 줄어든 날짜 크기 */
      line-height:1.1;color:#1b1f2a
    }
    .round{
      height:44px;border-radius:14px;border:1px solid #e7eaf3;background:#fff;cursor:pointer;font-weight:700
    }

    /* 버튼들 */
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{padding:14px 10px;border-radius:14px;border:1px solid #e7eaf3;background:#fff;font-weight:800;cursor:pointer}
    .btn.ghost{background:#fff}
    .btn.green{background:var(--green);border-color:var(--green);color:#fff}
    .btn.red{background:var(--red);border-color:var(--red);color:#fff}
    .btn:active{transform:translateY(1px)}
    .row2{display:flex;gap:12px;margin-top:12px}
    .row2>.btn{flex:1}

    /* ☆ 어려운 단어 : 아이콘 버튼(작게) */
    .tiny-icon{
      width:44px;height:44px;border-radius:12px;border:1px solid #e7eaf3;background:#fff;
      display:inline-flex;align-items:center;justify-content:center;cursor:pointer;font-size:20px;font-weight:900;
    }

    /* 속도/보이스 박스는 기존 스타일 유지 가정 */
    .section{margin-top:14px}

    /* 리스트 영역 */
    .list-area{
      margin-top:16px;background:#fff;border:1px solid #e7eaf3;border-radius:16px;padding:14px;
      color:#5c6275
    }

    @media (min-width:760px){
      .grid{grid-template-columns:repeat(4,1fr)}
    }
  </style>
</head>
<body>
  <!-- 헤더 -->
  <header class="appbar">
    <div class="row">
      <div class="brand">
        <div class="sub" style="font-size:14px;opacity:.9">오늘의 회화 영단어</div>
      </div>
      <div style="display:flex;gap:10px;">
        <button class="icon-btn" id="playAllBtn" title="전체 재생" aria-label="전체 재생">▶</button>
        <button class="icon-btn" id="moreBtn" title="메뉴" aria-label="메뉴">⋯</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="panel">

      <!-- 날짜 바 (작게) -->
      <div class="datebar">
        <button class="round" id="prevDayBtn" aria-label="이전 날짜">◀</button>
        <div class="date-chip" id="dateChip">YYYY-MM-DD</div>
        <button class="round" id="nextDayBtn" aria-label="다음 날짜">▶</button>
      </div>

      <!-- 컨트롤 버튼들 -->
      <div class="grid">
        <button class="btn ghost" id="btnAllPlay">전체 재생</button>
        <button class="btn ghost" id="btnStop">정지</button>

        <!-- 오늘분 완료 → 다음 날짜로 이동 -->
        <button class="btn green" id="btnDone">오늘분 완료</button>

        <!-- 오늘의 단어 → 오늘 날짜로 이동 -->
        <button class="btn ghost" id="btnToday">오늘의 단어</button>
      </div>

      <div class="row2" style="align-items:center">
        <!-- ☆ 작은 버튼 -->
        <button class="tiny-icon" id="btnHardTiny" title="어려운 단어" aria-label="어려운 단어">☆</button>

        <button class="btn ghost" id="btnLog">기록</button>
        <button class="btn red" id="btnDeleteLog">기록 삭제</button>
      </div>

      <!-- (예: 속도/보이스 영역 – 기존 로직 연결) -->
      <div class="section">
        <div style="font-weight:800;margin-bottom:6px">속도</div>
        <input type="range" id="speedRange" min="0.6" max="1.4" value="1.0" step="0.1" style="width:100%">
      </div>

      <!-- 단어 리스트 -->
      <div class="list-area" id="listArea">여기에 단어 리스트가 렌더링됩니다…</div>
    </section>
  </main>

  <script>
    /******** 날짜/네비게이션 유틸 ********/
    const dateChip = document.getElementById('dateChip');
    const btnPrev = document.getElementById('prevDayBtn');
    const btnNext = document.getElementById('nextDayBtn');
    const btnDone = document.getElementById('btnDone');
    const btnToday = document.getElementById('btnToday');

    // 앱 상태 날짜
    let currentDate = new Date();

    const fmt = (d) => {
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const day = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${day}`;
    };

    function renderDateChip(){
      dateChip.textContent = fmt(currentDate);
    }

    // 외부(기존) 코드에서 사용하던 훅을 살려둠
    function onDateChanged(iso){
      // 여기서 words.json 로드/렌더 등 기존 로직을 호출
      // 예시:
      // loadWordsFor(iso).then(renderWords);
      if (typeof window.loadWordsFor === 'function'){
        window.loadWordsFor(iso).then(list=>{
          if (typeof window.renderWords === 'function') window.renderWords(list);
        }).catch(()=>{
          const box = document.getElementById('listArea');
          box.textContent = '단어를 불러오지 못했습니다.';
        });
      } else {
        // 최소 표시
        const box = document.getElementById('listArea');
        box.innerHTML = `<div style="color:#1b1f2a;font-weight:800">예시</div>
          <div style="margin-top:6px;color:#6b7280">(${iso}) 단어 목록 로딩 훅을 연결하세요.</div>`;
      }
    }

    function setDate(d){
      currentDate = new Date(d.getFullYear(), d.getMonth(), d.getDate());
      renderDateChip();
      onDateChanged(fmt(currentDate));
    }

    function shiftDate(days){
      const d = new Date(currentDate);
      d.setDate(d.getDate()+days);
      setDate(d);
    }

    // 오늘 날짜로 이동
    function goToday(){
      setDate(new Date());
    }

    // 오늘분 완료 → 다음 날로 이동
    function markDoneAndNext(){
      // 기존 완료 처리 훅 (예: 기록 저장)
      if (typeof window.onMarkDone === 'function'){
        try { window.onMarkDone(fmt(currentDate)); } catch(e){}
      }
      shiftDate(1);
    }

    /******** 이벤트 바인딩 ********/
    btnPrev.addEventListener('click', ()=>shiftDate(-1));
    btnNext.addEventListener('click', ()=>shiftDate(1));
    btnDone.addEventListener('click', markDoneAndNext);
    btnToday.addEventListener('click', goToday);

    // 작아진 ☆ 버튼은 기존 어려운 단어 토글/페이지로 연결
    document.getElementById('btnHardTiny').addEventListener('click', ()=>{
      if (typeof window.openHardList === 'function') return window.openHardList();
      alert('어려운 단어 목록 기능을 연결하세요.');
    });

    // 초기 렌더
    goToday();

    /******** 아래는 기존 함수가 없을 때 최소 동작(삭제 가능) ********/
    // 데모용 renderWords
    if (typeof window.renderWords !== 'function'){
      window.renderWords = (list)=>{
        const box = document.getElementById('listArea');
        if (!list || !list.length){
          box.textContent = '단어가 없습니다.';
          return;
        }
        box.innerHTML = list.map((w,i)=>`
          <div style="padding:10px 8px;border-bottom:1px solid #eef1f6">
            <div style="font-weight:800">${i+1}. ${w.en ?? w.word ?? 'word'}</div>
            <div style="color:#6b7280;margin-top:4px">${w.ko ?? w.mean ?? ''}</div>
          </div>
        `).join('');
      };
      // 데모용 loadWordsFor
      window.loadWordsFor = async (iso)=>{
        // 실제 환경에선 날짜별 words.json/Firestore에서 로딩
        return [
          {en:'make do with', ko:'임시방편으로 사용하다'},
          {en:'stick to', ko:'고수하다'},
          {en:'get along with', ko:'잘 지내다'},
        ];
      };
    }
  </script>
</body>
</html>
