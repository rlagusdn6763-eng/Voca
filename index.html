<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ì˜¤ëŠ˜ì˜ íšŒí™” ì˜ë‹¨ì–´</title>
<style>
  body{margin:0;background:#0f172a;color:#e5e7eb;
       font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Arial}
  .wrap{max-width:860px;margin:32px auto;padding:0 16px}
  h1{margin:0;font-size:26px}
  .sub{color:#9ca3af;font-size:14px;margin:4px 0 16px}
  .card{background:#111827;border:1px solid #1f2937;border-radius:16px;padding:16px}
  .row{display:grid;grid-template-columns:1fr auto;gap:8px;padding:12px 10px;border-top:1px dashed #1f2937}
  .row:first-child{border-top:none}
  .en{font-weight:700;font-size:18px}
  .ko{color:#9ca3af;font-size:14px}
  .btns{display:flex;gap:8px}
  button{background:#0b7285;border:1px solid #0c8599;color:#fff;padding:6px 10px;border-radius:8px;cursor:pointer;font-size:13px}
  button.secondary{background:#334155;border-color:#334155}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin-bottom:16px}
  select,input[type="range"]{background:#0b1324;border:1px solid #1f2937;color:#e5e7eb;padding:6px 8px;border-radius:8px;font-size:13px}
  footer{color:#9ca3af;font-size:12px;margin-top:20px;text-align:center}
</style>
</head>
<body>
<div class="wrap">
  <h1>ì˜¤ëŠ˜ì˜ íšŒí™” ì˜ë‹¨ì–´</h1>
  <div class="sub">í´ë¦­í•´ì„œ ë°œìŒ ë“¤ì–´ë³´ê¸°</div>

  <div class="toolbar">
    <button id="playAll">ì „ì²´ ì¬ìƒ</button>
    <button id="stopAll" class="secondary">ì •ì§€</button>
    <select id="voiceSelect" title="ì˜ì–´ ìŒì„± ì„ íƒ"></select>
    <label class="sub">ì†ë„ <input id="rate" type="range" min="0.6" max="1.2" step="0.05" value="1"></label>
  </div>

  <div class="card" id="list"></div>

  <div class="sub" style="margin-top:8px">
    ğŸ’¡ ë°œìŒì´ ì–´ìƒ‰í•˜ë©´ ìœ„ì˜ <b>voice</b>ì—ì„œ English(US/UK) ìŒì„±ì„ ê³ ë¥´ì„¸ìš”.
  </div>
  <footer>GitHub Pages Â· Web Speech API</footer>
</div>

<script>
async function loadWords(){
  const res = await fetch('words.json?cachebust=' + Date.now());
  const data = await res.json();
  render(data);
}
function render(data){
  const list=document.getElementById('list');
  list.innerHTML='';
  data.forEach((it,i)=>{
    const row=document.createElement('div');
    row.className='row';
    row.innerHTML=`
      <div>
        <div class="en">${it.phrase}</div>
        <div class="ko">${it.meaning}</div>
      </div>
      <div class="btns">
        <button data-i="${i}" class="speak">â–¶ ì¬ìƒ</button>
        <button data-i="${i}" class="slow secondary">ëŠë¦¬ê²Œ</button>
      </div>`;
    list.appendChild(row);
  });

  let voices=[];
  const voiceSelect=document.getElementById('voiceSelect');
  const rateEl=document.getElementById('rate');
  function fillVoices(){
    voices=speechSynthesis.getVoices();
    const en=voices.filter(v=>/en(-|_)|English/i.test(v.lang));
    voiceSelect.innerHTML='';
    (en.length?en:voices).forEach(v=>{
      const o=document.createElement('option');
      o.value=v.name;o.textContent=`${v.name} â€” ${v.lang}`;
      voiceSelect.appendChild(o);
    });
  }
  fillVoices(); speechSynthesis.onvoiceschanged=fillVoices;

  function speak(text,rate=1){
    speechSynthesis.cancel();
    const u=new SpeechSynthesisUtterance(text);
    const chosen=voices.find(v=>v.name===voiceSelect.value);
    if(chosen) u.voice=chosen;
    u.lang=(chosen&&chosen.lang)||'en-US';
    u.rate=rate;
    speechSynthesis.speak(u);
  }
  list.querySelectorAll('.speak').forEach(b=>b.onclick=e=>{
    speak(data[+e.target.dataset.i].phrase, Number(rateEl.value));
  });
  list.querySelectorAll('.slow').forEach(b=>b.onclick=e=>{
    speak(data[+e.target.dataset.i].phrase, 0.8);
  });
  document.getElementById('playAll').onclick=async()=>{
    speechSynthesis.cancel();
    const rate=Number(rateEl.value);
    for(const item of data){
      await new Promise(res=>{
        const u=new SpeechSynthesisUtterance(item.phrase);
        const chosen=voices.find(v=>v.name===voiceSelect.value);
        if(chosen) u.voice=chosen;
        u.lang=(chosen&&chosen.lang)||'en-US';
        u.rate=rate;
        u.onend=()=>setTimeout(res,200);
        speechSynthesis.speak(u);
      });
    }
  };
  document.getElementById('stopAll').onclick=()=>speechSynthesis.cancel();
}
loadWords();
</script>
</body>
</html>
