<!DOCTYPE html>
<html lang="ko">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>오늘의 회화 영단어</title>
<style>
  body{margin:0;background:#0f172a;color:#e5e7eb;font-family:system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Apple SD Gothic Neo,Arial}
  .wrap{max-width:860px;margin:32px auto;padding:0 16px}
  .sub{color:#9ca3af;font-size:14px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.02));
        border:1px solid #1f2937;border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.3)}
  .row{display:grid;grid-template-columns:1fr auto;gap:8px;padding:12px 10px;border-top:1px dashed #1f2937}
  .row:first-child{border-top:none}
  .en{font-weight:700;font-size:18px}
  .ko{color:#9ca3af;font-size:14px}
  .btns{display:flex;gap:8px}
  button{background:#0b7285;border:1px solid #0c8599;color:#fff;padding:8px 10px;border-radius:10px;cursor:pointer;font-size:13px}
  button.secondary{background:#334155;border-color:#334155}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:12px 0 16px}
  select,input[type="range"]{background:#0b1324;border:1px solid #1f2937;color:#e5e7eb;padding:8px 10px;border-radius:10px;font-size:13px}
  footer{color:#9ca3af;font-size:12px;margin-top:20px;text-align:center}
</style>
<body>
<div class="wrap">
  <h1 style="margin:0">오늘의 회화 영단어</h1>
  <div class="sub">클릭해서 발음 들어보기</div>

  <div class="toolbar">
    <button id="playAll">전체 재생</button>
    <button id="stopAll" class="secondary">정지</button>
    <select id="voiceSelect" title="영어 음성 선택"></select>
    <label class="sub">속도 <input id="rate" type="range" min="0.6" max="1.2" step="0.05" value="1"></label>
  </div>

  <div class="card" id="list"></div>

  <div class="sub" style="margin-top:8px">
    💡 발음이 어색하면 위의 <b>voice</b>에서 English(US/UK) 음성을 고르세요. 기기마다 제공 음성이 다를 수 있어요.
  </div>
  <footer>Web Speech API 사용 · 오프라인에서도 작동</footer>
</div>

<script>
const data = [
  {phrase:"grab a bite", meaning:"간단히 먹다"},
  {phrase:"hang out", meaning:"놀다, 어울리다"},
  {phrase:"catch up", meaning:"밀린 얘기를 하다"},
  {phrase:"chill", meaning:"쉬다, 여유부리다"},
  {phrase:"figure out", meaning:"이해하다, 해결하다"},
  {phrase:"show up", meaning:"나타나다"},
  {phrase:"run into", meaning:"우연히 만나다"},
  {phrase:"call it a day", meaning:"오늘은 여기까지 하다"},
  {phrase:"in no time", meaning:"금방, 순식간에"},
  {phrase:"take your time", meaning:"천천히 하다"},
];

const list = document.getElementById('list');
function row(item, i){
  const el = document.createElement('div');
  el.className='row';
  el.innerHTML = `
    <div>
      <div class="en">${item.phrase}</div>
      <div class="ko">${item.meaning}</div>
    </div>
    <div class="btns">
      <button data-i="${i}" class="speak">▶ 재생</button>
      <button data-i="${i}" class="slow secondary">느리게</button>
    </div>`;
  return el;
}
data.forEach((it,i)=>list.appendChild(row(it,i)));

let voices = [];
const voiceSelect = document.getElementById('voiceSelect');
const rateEl = document.getElementById('rate');
function fillVoices(){
  voices = speechSynthesis.getVoices();
  const en = voices.filter(v=>/en(-|_)|English/i.test(v.lang));
  voiceSelect.innerHTML = '';
  (en.length?en:voices).forEach(v=>{
    const o=document.createElement('option');
    o.value=v.name; o.textContent=`${v.name} — ${v.lang}`;
    voiceSelect.appendChild(o);
  });
}
fillVoices();
speechSynthesis.onvoiceschanged = fillVoices;

function speak(text, rate=1){
  if(!('speechSynthesis' in window)) return alert('이 브라우저는 지원하지 않아요.');
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  const chosen = voices.find(v=>v.name===voiceSelect.value);
  if(chosen) u.voice = chosen;
  u.lang = (chosen&&chosen.lang) || 'en-US';
  u.rate = rate;
  speechSynthesis.speak(u);
}

document.querySelectorAll('.speak').forEach(b=>b.onclick = e=>{
  const i = +e.currentTarget.dataset.i;
  speak(data[i].phrase, Number(rateEl.value));
});
document.querySelectorAll('.slow').forEach(b=>b.onclick = e=>{
  const i = +e.currentTarget.dataset.i;
  speak(data[i].phrase, 0.8);
});

document.getElementById('playAll').onclick = async ()=>{
  speechSynthesis.cancel();
  const rate = Number(rateEl.value);
  for(let i=0;i<data.length;i++){
    await new Promise(res=>{
      const u = new SpeechSynthesisUtterance(data[i].phrase);
      const chosen = voices.find(v=>v.name===voiceSelect.value);
      if(chosen) u.voice = chosen;
      u.lang = (chosen&&chosen.lang) || 'en-US';
      u.rate = rate;
      u.onend = ()=>setTimeout(res, 250);
      speechSynthesis.speak(u);
    });
  }
};
document.getElementById('stopAll').onclick = ()=>speechSynthesis.cancel();
</script>
</body>
</html>
