<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>오늘의 회화 영단어</title>
<style>
  :root{
    --bg:#eef2f7;
    --ink:#0f172a;
    --muted:#54657e;
    --card:#ffffff;
    --border:#d9e1ee;
    --accent:#0ea5a5;
    --accent-weak:#9be2e2;
    --warn:#b45309;
    --ok:#0f766e;
  }
  *{box-sizing:border-box}
  body{margin:0;color:var(--ink);background:var(--bg);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Pretendard,Apple SD Gothic Neo,Malgun Gothic,sans-serif;}
  header{max-width:980px;margin:24px auto 10px;padding:0 16px;display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  h1{font-size:28px;margin:0 8px 0 0}
  .sub{color:var(--muted);font-size:14px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .chip{border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:13px;background:#f7fbff}
  .badge-ok{background:#e7f7f5;border-color:#bfe9e5;color:#0b4c47}
  .btn{border:1px solid var(--border);background:#f8fbff;color:var(--ink);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700}
  .btn:hover{border-color:#c9d6ea;background:#f2f7ff}
  .btn.primary{background:#e8fbfb;border-color:var(--accent-weak);color:#086868}
  .btn.ok{background:#e9f8f6;border-color:#bfe9e5;color:#0b4c47}
  .btn.warn{background:#fff5e8;border-color:#f6d3a1;color:#7a4a08}
  .datebox{display:flex;align-items:center;gap:8px}
  .date{font-variant-numeric:tabular-nums;font-weight:800;letter-spacing:.2px}
  main{max-width:980px;margin:8px auto 32px;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:16px;
    padding:14px 16px;display:grid;gap:8px;box-shadow:0 2px 10px rgba(10,30,80,.06)}
  .grid{display:grid;gap:14px}
  @media(min-width:760px){.grid{grid-template-columns:1fr 1fr}}
  .en{font-size:20px;font-weight:800}
  .ko{font-size:15px;color:var(--muted)}
  .ex{font-size:13px;color:#334155;background:#f0f6ff;border-left:4px solid var(--accent);padding:8px;border-radius:8px}
  .play{margin-left:auto}
  .star{border:none;background:transparent;cursor:pointer;font-size:20px;line-height:1;color:#c3cad5}
  .star.active{color:#f59e0b}
  .tabs{display:flex;gap:8px;margin:14px 0}
  .tab-btn{padding:8px 12px;border:1px solid var(--border);background:#f7fbff;border-radius:10px;cursor:pointer}
  .tab-btn.active{border-color:var(--accent-weak);background:#e8fbfb;color:#075e5e}
  .list{display:grid;gap:10px}
  .empty{color:var(--muted);padding:10px}
  .footer{margin-top:18px;display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .select{background:#fff;color:var(--ink);border:1px solid var(--border);padding:8px 10px;border-radius:10px}
  .pill{padding:4px 8px;border-radius:999px;background:#eef6ff;border:1px solid var(--border);font-size:12px;color:#335}
</style>
</head>
<body>
  <header>
    <h1>오늘의 회화 영단어</h1>
    <span id="doneBadge" class="chip badge-ok" hidden>✔ 오늘분 학습 완료</span>
    <div class="row" style="margin-left:auto">
      <div class="datebox">
        <button id="prevBtn" class="btn" title="이전 날짜">◀</button>
        <span id="dateLabel" class="date"></span>
        <button id="nextBtn" class="btn" title="다음 날짜">▶</button>
      </div>
      <button id="speakAllBtn" class="btn primary">전체 재생</button>
      <button id="stopAllBtn" class="btn warn">정지</button>
      <button id="completeBtn" class="btn ok">오늘분 완료</button>
    </div>
    <div class="row" style="width:100%"><span class="sub">카드를 클릭해 발음(영→한)을 들어보세요 · 영어는 영어 음성, 한국어 뜻은 한국어 음성으로 읽어요.</span></div>
  </header>

  <main>
    <div class="tabs">
      <button class="tab-btn active" data-tab="today">오늘 단어</button>
      <button class="tab-btn" data-tab="history">기록 보기</button>
      <button class="tab-btn" data-tab="hard">어려운 단어</button>
    </div>

    <section id="todayTab">
      <div id="words" class="grid"></div>
      <div class="footer">
        <label class="chip">속도 <input id="rate" type="range" min="0.6" max="1.4" step="0.1" value="1" style="vertical-align:middle;margin-left:8px"></label>
      </div>
    </section>

    <section id="historyTab" hidden>
      <div class="row" style="margin-bottom:12px">
        <select id="dateFilter" class="select"></select>
        <button id="viewDayBtn" class="btn">보기</button>
        <button id="clearHistBtn" class="btn warn">기록 초기화</button>
      </div>
      <div id="histList" class="list"></div>
    </section>

    <section id="hardTab" hidden>
      <div class="row" style="margin-bottom:12px">
        <span class="pill" id="hardCount">0개 저장됨</span>
        <button id="clearHardBtn" class="btn warn">어려운 단어 비우기</button>
      </div>
      <div id="hardList" class="list"></div>
    </section>
  </main>

<script>
(() => {
  /* 상태 변수 */
  let stopAll = false;

  const $=s=>document.querySelector(s);
  const fmt = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`;
  const midnight = (d=new Date())=>{const x=new Date(d);x.setHours(0,0,0,0);return x;}
  const loadJSON = async (urls)=>{
    for (const u of urls){ try{ const r=await fetch(u,{cache:"no-store"}); if(r.ok) return await r.json(); }catch(e){} }
    return null;
  };
  const speak=(text,lang,rate=1)=>{
    if(!window.speechSynthesis) return;
    const u=new SpeechSynthesisUtterance(text); u.lang=lang; u.rate=rate;
    speechSynthesis.speak(u);
  };

  /* 예시 단어 목록 */
  const words=[{phrase:"work out",meaning:"운동하다, 해결하다",example:"I work out at the gym."},
               {phrase:"bring up",meaning:"화제를 꺼내다",example:"She brought up an interesting point."}];

  const listEl=$("#words");
  const render=()=>{
    listEl.innerHTML="";
    words.forEach(w=>{
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`<div class="row">
          <div class="en">${w.phrase}</div>
          <button class="btn play">▶ 발음</button>
        </div>
        <div class="ko">${w.meaning}</div>
        <div class="ex">예문: ${w.example}</div>`;
      card.querySelector(".play").onclick=()=>{
        const rate=Number($("#rate").value||"1");
        speak(w.phrase,"en-US",rate);
        setTimeout(()=>speak(w.meaning,"ko-KR",rate),350);
      };
      listEl.append(card);
    });
  };

  /* 전체 재생 */
  $("#speakAllBtn").onclick=()=>{
    stopAll=false;
    const cards=listEl.querySelectorAll(".card");
    const rate=Number($("#rate").value||"1"); let i=0;
    const playNext=()=>{
      if(stopAll || i>=cards.length) return;
      const en=cards[i].querySelector(".en").textContent;
      const ko=cards[i].querySelector(".ko").textContent;
      speak(en,"en-US",rate);
      setTimeout(()=>{
        if(ko) speak(ko,"ko-KR",rate);
        setTimeout(()=>{i++;playNext();},500);
      },420);
    };
    playNext();
  };

  /* 정지 버튼 */
  $("#stopAllBtn").onclick=()=>{
    stopAll=true;
    speechSynthesis.cancel();
  };

  render();
})();
</script>
</body>
</html>
